import{$ as y,a7 as H,a6 as T,d as Q,a2 as yt,bN as Lt,I as c,bZ as he,b_ as ae,b$ as pe,c0 as ve,c1 as ue,c2 as ke,c3 as be,r as L,az as _e,aA as Se,H as Y,a1 as Nt,a9 as xt,an as wt,c4 as De,c5 as Ke,c6 as Ge,c7 as Xe,aH as Tt,aL as Ht,a0 as nt,aR as Bt,O as kt,c8 as qt,a3 as Ot,ab as je,w as _t,aN as st,a5 as jt,bm as Kt,aF as Gt,x as St,bk as Xt,ac as ze,bW as Ne,bv as Ct,as as Zt,bI as Yt,bJ as Jt,o as ot,j as it,g as N,b as O,c9 as Qt,e as Wt,T as X}from"./main-cd20fe6b.js";import{_ as er,u as tr}from"./Input-2e5ac349.js";import{u as at}from"./use-merged-state-3065e8b8.js";import{u as Ze,V as rr,a as nr,b as sr}from"./Follower-a07f1475.js";import{_ as or}from"./Space-70892829.js";import{b as lt}from"./route-block-7ae06361.js";import"./on-fonts-ready-15e70727.js";function Mt(e,t,r){t/=100,r/=100;const n=t*Math.min(r,1-r)+r;return[e,n?(2-2*r/n)*100:0,n*100]}function Te(e,t,r){t/=100,r/=100;const n=r-r*t/2,s=Math.min(n,1-n);return[e,s?(r-n)/s*100:0,n*100]}function ce(e,t,r){t/=100,r/=100;let n=(s,o=(s+e/60)%6)=>r-r*t*Math.max(Math.min(o,4-o,1),0);return[n(5)*255,n(3)*255,n(1)*255]}function Ye(e,t,r){e/=255,t/=255,r/=255;let n=Math.max(e,t,r),s=n-Math.min(e,t,r),o=s&&(n==e?(t-r)/s:n==t?2+(r-e)/s:4+(e-t)/s);return[60*(o<0?o+6:o),n&&s/n*100,n*100]}function Je(e,t,r){e/=255,t/=255,r/=255;let n=Math.max(e,t,r),s=n-Math.min(e,t,r),o=1-Math.abs(n+n-s-1),a=s&&(n==e?(t-r)/s:n==t?2+(r-e)/s:4+(e-t)/s);return[60*(a<0?a+6:a),o?s/o*100:0,(n+n-s)*50]}function Qe(e,t,r){t/=100,r/=100;let n=t*Math.min(r,1-r),s=(o,a=(o+e/30)%12)=>r-n*Math.max(Math.min(a-3,9-a,1),-1);return[s(0)*255,s(8)*255,s(4)*255]}const ir=y("input-group",`
 display: inline-flex;
 width: 100%;
 flex-wrap: nowrap;
 vertical-align: bottom;
`,[H(">",[y("input",[H("&:not(:last-child)",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),H("&:not(:first-child)",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 margin-left: -1px!important;
 `)]),y("button",[H("&:not(:last-child)",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `,[T("state-border, border",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `)]),H("&:not(:first-child)",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `,[T("state-border, border",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `)])]),H("*",[H("&:not(:last-child)",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `,[H(">",[y("input",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),y("base-selection",[y("base-selection-label",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),y("base-selection-tags",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),T("box-shadow, border, state-border",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `)])])]),H("&:not(:first-child)",`
 margin-left: -1px!important;
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `,[H(">",[y("input",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `),y("base-selection",[y("base-selection-label",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `),y("base-selection-tags",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `),T("box-shadow, border, state-border",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `)])])])])])]),ar={},lr=Q({name:"InputGroup",props:ar,setup(e){const{mergedClsPrefixRef:t}=yt(e);return Lt("-input-group",ir,t),{mergedClsPrefix:t}},render(){const{mergedClsPrefix:e}=this;return c("div",{class:`${e}-input-group`},this.$slots)}});function ur(e,t){switch(e[0]){case"hex":return t?"#000000FF":"#000000";case"rgb":return t?"rgba(0, 0, 0, 1)":"rgb(0, 0, 0)";case"hsl":return t?"hsla(0, 0%, 0%, 1)":"hsl(0, 0%, 0%)";case"hsv":return t?"hsva(0, 0%, 0%, 1)":"hsv(0, 0%, 0%)"}return"#000000"}function Ue(e){return e===null?null:/^ *#/.test(e)?"hex":e.includes("rgb")?"rgb":e.includes("hsl")?"hsl":e.includes("hsv")?"hsv":null}function dr(e){return e=Math.round(e),e>=360?359:e<0?0:e}function cr(e){return e=Math.round(e*100)/100,e>1?1:e<0?0:e}const hr={rgb:{hex(e){return he(ae(e))},hsl(e){const[t,r,n,s]=ae(e);return pe([...Je(t,r,n),s])},hsv(e){const[t,r,n,s]=ae(e);return ve([...Ye(t,r,n),s])}},hex:{rgb(e){return ue(ae(e))},hsl(e){const[t,r,n,s]=ae(e);return pe([...Je(t,r,n),s])},hsv(e){const[t,r,n,s]=ae(e);return ve([...Ye(t,r,n),s])}},hsl:{hex(e){const[t,r,n,s]=ke(e);return he([...Qe(t,r,n),s])},rgb(e){const[t,r,n,s]=ke(e);return ue([...Qe(t,r,n),s])},hsv(e){const[t,r,n,s]=ke(e);return ve([...Mt(t,r,n),s])}},hsv:{hex(e){const[t,r,n,s]=be(e);return he([...ce(t,r,n),s])},rgb(e){const[t,r,n,s]=be(e);return ue([...ce(t,r,n),s])},hsl(e){const[t,r,n,s]=be(e);return pe([...Te(t,r,n),s])}}};function Pt(e,t,r){return r=r||Ue(e),r?r===t?e:hr[r][t](e):null}const xe="12px",pr=12,me="6px",fr=6,mr="linear-gradient(90deg,red,#ff0 16.66%,#0f0 33.33%,#0ff 50%,#00f 66.66%,#f0f 83.33%,red)",gr=Q({name:"HueSlider",props:{clsPrefix:{type:String,required:!0},hue:{type:Number,required:!0},onUpdateHue:{type:Function,required:!0},onComplete:Function},setup(e){const t=L(null);function r(o){!t.value||(_e("mousemove",document,n),_e("mouseup",document,s),n(o))}function n(o){const{value:a}=t;if(!a)return;const{width:i,left:d}=a.getBoundingClientRect(),v=dr((o.clientX-d-fr)/(i-pr)*360);e.onUpdateHue(v)}function s(){var o;Se("mousemove",document,n),Se("mouseup",document,s),(o=e.onComplete)===null||o===void 0||o.call(e)}return{railRef:t,handleMouseDown:r}},render(){const{clsPrefix:e}=this;return c("div",{class:`${e}-color-picker-slider`,style:{height:xe,borderRadius:me}},c("div",{ref:"railRef",style:{boxShadow:"inset 0 0 2px 0 rgba(0, 0, 0, .24)",boxSizing:"border-box",backgroundImage:mr,height:xe,borderRadius:me,position:"relative"},onMousedown:this.handleMouseDown},c("div",{style:{position:"absolute",left:me,right:me,top:0,bottom:0}},c("div",{class:`${e}-color-picker-handle`,style:{left:`calc((${this.hue}%) / 359 * 100 - ${me})`,borderRadius:me,width:xe,height:xe}},c("div",{class:`${e}-color-picker-handle__fill`,style:{backgroundColor:`hsl(${this.hue}, 100%, 50%)`,borderRadius:me,width:xe,height:xe}})))))}}),Pe="12px",vr=12,ge="6px",br=Q({name:"AlphaSlider",props:{clsPrefix:{type:String,required:!0},rgba:{type:Array,default:null},alpha:{type:Number,default:0},onUpdateAlpha:{type:Function,required:!0},onComplete:Function},setup(e){const t=L(null);function r(o){!t.value||!e.rgba||(_e("mousemove",document,n),_e("mouseup",document,s),n(o))}function n(o){const{value:a}=t;if(!a)return;const{width:i,left:d}=a.getBoundingClientRect(),v=(o.clientX-d)/(i-vr);e.onUpdateAlpha(cr(v))}function s(){var o;Se("mousemove",document,n),Se("mouseup",document,s),(o=e.onComplete)===null||o===void 0||o.call(e)}return{railRef:t,railBackgroundImage:Y(()=>{const{rgba:o}=e;return o?`linear-gradient(to right, rgba(${o[0]}, ${o[1]}, ${o[2]}, 0) 0%, rgba(${o[0]}, ${o[1]}, ${o[2]}, 1) 100%)`:""}),handleMouseDown:r}},render(){const{clsPrefix:e}=this;return c("div",{class:`${e}-color-picker-slider`,ref:"railRef",style:{height:Pe,borderRadius:ge},onMousedown:this.handleMouseDown},c("div",{style:{borderRadius:ge,position:"absolute",left:0,right:0,top:0,bottom:0,overflow:"hidden"}},c("div",{class:`${e}-color-picker-checkboard`}),c("div",{class:`${e}-color-picker-slider__image`,style:{backgroundImage:this.railBackgroundImage}})),this.rgba&&c("div",{style:{position:"absolute",left:ge,right:ge,top:0,bottom:0}},c("div",{class:`${e}-color-picker-handle`,style:{left:`calc(${this.alpha*100}% - ${ge})`,borderRadius:ge,width:Pe,height:Pe}},c("div",{class:`${e}-color-picker-handle__fill`,style:{backgroundColor:ue(this.rgba),borderRadius:ge,width:Pe,height:Pe}}))))}}),Ie="12px",Le="6px",yr=Q({name:"Pallete",props:{clsPrefix:{type:String,required:!0},rgba:{type:Array,default:null},displayedHue:{type:Number,required:!0},displayedSv:{type:Array,required:!0},onUpdateSV:{type:Function,required:!0},onComplete:Function},setup(e){const t=L(null);function r(o){!t.value||(_e("mousemove",document,n),_e("mouseup",document,s),n(o))}function n(o){const{value:a}=t;if(!a)return;const{width:i,height:d,left:v,bottom:A}=a.getBoundingClientRect(),x=(A-o.clientY)/d,B=(o.clientX-v)/i,w=100*(B>1?1:B<0?0:B),f=100*(x>1?1:x<0?0:x);e.onUpdateSV(w,f)}function s(){var o;Se("mousemove",document,n),Se("mouseup",document,s),(o=e.onComplete)===null||o===void 0||o.call(e)}return{palleteRef:t,handleColor:Y(()=>{const{rgba:o}=e;return o?`rgb(${o[0]}, ${o[1]}, ${o[2]})`:""}),handleMouseDown:r}},render(){const{clsPrefix:e}=this;return c("div",{class:`${e}-color-picker-pallete`,onMousedown:this.handleMouseDown,ref:"palleteRef"},c("div",{class:`${e}-color-picker-pallete__layer`,style:{backgroundImage:`linear-gradient(90deg, white, hsl(${this.displayedHue}, 100%, 50%))`}}),c("div",{class:`${e}-color-picker-pallete__layer ${e}-color-picker-pallete__layer--shadowed`,style:{backgroundImage:"linear-gradient(180deg, rgba(0, 0, 0, 0%), rgba(0, 0, 0, 100%))"}}),this.rgba&&c("div",{class:`${e}-color-picker-handle`,style:{width:Ie,height:Ie,borderRadius:Le,left:`calc(${this.displayedSv[0]}% - ${Le})`,bottom:`calc(${this.displayedSv[1]}% - ${Le})`}},c("div",{class:`${e}-color-picker-handle__fill`,style:{backgroundColor:this.handleColor,borderRadius:Le,width:Ie,height:Ie}})))}}),rt=Nt("n-color-picker");function xr(e){return/^\d{1,3}\.?\d*$/.test(e.trim())?Math.max(0,Math.min(parseInt(e),255)):!1}function wr(e){return/^\d{1,3}\.?\d*$/.test(e.trim())?Math.max(0,Math.min(parseInt(e),360)):!1}function kr(e){return/^\d{1,3}\.?\d*$/.test(e.trim())?Math.max(0,Math.min(parseInt(e),100)):!1}function _r(e){const t=e.trim();return/^#[0-9a-fA-F]+$/.test(t)?[4,5,7,9].includes(t.length):!1}function Sr(e){return/^\d{1,3}\.?\d*%$/.test(e.trim())?Math.max(0,Math.min(parseInt(e)/100,100)):!1}const Cr={paddingSmall:"0 4px"},ut=Q({name:"ColorInputUnit",props:{label:{type:String,required:!0},value:{type:[Number,String],default:null},showAlpha:Boolean,onUpdateValue:{type:Function,required:!0}},setup(e){const t=L(""),{themeRef:r}=xt(rt,null);wt(()=>{t.value=n()});function n(){const{value:a}=e;if(a===null)return"";const{label:i}=e;return i==="HEX"?a:i==="A"?`${Math.floor(a*100)}%`:String(Math.floor(a))}function s(a){t.value=a}function o(a){let i,d;switch(e.label){case"HEX":d=_r(a),d&&e.onUpdateValue(a),t.value=n();break;case"H":i=wr(a),i===!1?t.value=n():e.onUpdateValue(i);break;case"S":case"L":case"V":i=kr(a),i===!1?t.value=n():e.onUpdateValue(i);break;case"A":i=Sr(a),i===!1?t.value=n():e.onUpdateValue(i);break;case"R":case"G":case"B":i=xr(a),i===!1?t.value=n():e.onUpdateValue(i);break}}return{mergedTheme:r,inputValue:t,handleInputChange:o,handleInputUpdateValue:s}},render(){const{mergedTheme:e}=this;return c(er,{size:"small",placeholder:this.label,theme:e.peers.Input,themeOverrides:e.peerOverrides.Input,builtinThemeOverrides:Cr,value:this.inputValue,onUpdateValue:this.handleInputUpdateValue,onChange:this.handleInputChange,style:this.label==="A"?"flex-grow: 1.25;":""})}}),Mr=Q({name:"ColorInput",props:{clsPrefix:{type:String,required:!0},mode:{type:String,required:!0},modes:{type:Array,required:!0},showAlpha:{type:Boolean,required:!0},value:{type:String,default:null},valueArr:{type:Array,default:null},onUpdateValue:{type:Function,required:!0},onUpdateMode:{type:Function,required:!0}},setup(e){return{handleUnitUpdateValue(t,r){const{showAlpha:n}=e;if(e.mode==="hex"){e.onUpdateValue((n?he:De)(r));return}let s;switch(e.valueArr===null?s=[0,0,0,0]:s=Array.from(e.valueArr),e.mode){case"hsv":s[t]=r,e.onUpdateValue((n?ve:Xe)(s));break;case"rgb":s[t]=r,e.onUpdateValue((n?ue:Ge)(s));break;case"hsl":s[t]=r,e.onUpdateValue((n?pe:Ke)(s));break}}}},render(){const{clsPrefix:e,modes:t}=this;return c("div",{class:`${e}-color-picker-input`},c("div",{class:`${e}-color-picker-input__mode`,onClick:this.onUpdateMode,style:{cursor:t.length===1?"":"pointer"}},this.mode.toUpperCase()+(this.showAlpha?"A":"")),c(lr,null,{default:()=>{const{mode:r,valueArr:n,showAlpha:s}=this;if(r==="hex"){let o=null;try{o=n===null?null:(s?he:De)(n)}catch{}return c(ut,{label:"HEX",showAlpha:s,value:o,onUpdateValue:a=>{this.handleUnitUpdateValue(0,a)}})}return(r+(s?"a":"")).split("").map((o,a)=>c(ut,{label:o.toUpperCase(),value:n===null?null:n[a],onUpdateValue:i=>{this.handleUnitUpdateValue(a,i)}}))}}))}}),Pr=Q({name:"ColorPickerTrigger",props:{clsPrefix:{type:String,required:!0},value:{type:String,default:null},hsla:{type:Array,default:null},disabled:Boolean,onClick:Function},setup(e){const{colorPickerSlots:t,renderLabelRef:r}=xt(rt,null);return()=>{const{hsla:n,value:s,clsPrefix:o,onClick:a,disabled:i}=e,d=t.label||r.value;return c("div",{class:[`${o}-color-picker-trigger`,i&&`${o}-color-picker-trigger--disabled`],onClick:i?void 0:a},c("div",{class:`${o}-color-picker-trigger__fill`},c("div",{class:`${o}-color-picker-checkboard`}),c("div",{style:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundColor:n?pe(n):""}}),s&&n?c("div",{class:`${o}-color-picker-trigger__value`,style:{color:n[2]>50||n[3]<.5?"black":"white"}},d?d(s):s):null))}}});function $r(e,t){if(t==="hsv"){const[r,n,s,o]=be(e);return ue([...ce(r,n,s),o])}return e}function Er(e){const t=document.createElement("canvas").getContext("2d");return t.fillStyle=e,t.fillStyle}const Ar=Q({name:"ColorPickerSwatches",props:{clsPrefix:{type:String,required:!0},mode:{type:String,required:!0},swatches:{type:Array,required:!0},onUpdateColor:{type:Function,required:!0}},setup(e){const t=Y(()=>e.swatches.map(o=>{const a=Ue(o);return{value:o,mode:a,legalValue:$r(o,a)}}));function r(o){const{mode:a}=e;let{value:i,mode:d}=o;return d||(d="hex",/^[a-zA-Z]+$/.test(i)?i=Er(i):(Tt("color-picker",`color ${i} in swatches is invalid.`),i="#000000")),d===a?i:Pt(i,a,d)}function n(o){e.onUpdateColor(r(o))}function s(o,a){o.key==="Enter"&&n(a)}return{parsedSwatchesRef:t,handleSwatchSelect:n,handleSwatchKeyDown:s}},render(){const{clsPrefix:e}=this;return c("div",{class:`${e}-color-picker-swatches`},this.parsedSwatchesRef.map(t=>c("div",{class:`${e}-color-picker-swatch`,tabindex:0,onClick:()=>this.handleSwatchSelect(t),onKeydown:r=>this.handleSwatchKeyDown(r,t)},c("div",{class:`${e}-color-picker-swatch__fill`,style:{background:t.legalValue}}))))}}),Dr=Q({name:"ColorPreview",props:{clsPrefix:{type:String,required:!0},mode:{type:String,required:!0},color:{type:String,default:null,validator:e=>{const t=Ue(e);return Boolean(!e||t&&t!=="hsv")}},onUpdateColor:{type:Function,required:!0}},setup(e){function t(r){var n;const s=r.target.value;(n=e.onUpdateColor)===null||n===void 0||n.call(e,Pt(s.toUpperCase(),e.mode,"hex")),r.stopPropagation()}return{handleChange:t}},render(){const{clsPrefix:e}=this;return c("div",{class:`${e}-color-picker-preview__preview`},c("span",{class:`${e}-color-picker-preview__fill`,style:{background:this.color||"#000000"}}),c("input",{class:`${e}-color-picker-preview__input`,type:"color",value:this.color,onChange:this.handleChange}))}}),Ur=H([y("color-picker",`
 display: inline-block;
 box-sizing: border-box;
 height: var(--n-height);
 font-size: var(--n-font-size);
 width: 100%;
 position: relative;
 `),y("color-picker-panel",`
 margin: 4px 0;
 width: 240px;
 font-size: var(--n-panel-font-size);
 color: var(--n-text-color);
 background-color: var(--n-color);
 transition:
 box-shadow .3s var(--n-bezier),
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 box-shadow: var(--n-box-shadow);
 `,[Ht(),y("input",`
 text-align: center;
 `)]),y("color-picker-checkboard",`
 background: white; 
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `,[H("&::after",`
 background-image: linear-gradient(45deg, #DDD 25%, #0000 25%), linear-gradient(-45deg, #DDD 25%, #0000 25%), linear-gradient(45deg, #0000 75%, #DDD 75%), linear-gradient(-45deg, #0000 75%, #DDD 75%);
 background-size: 12px 12px;
 background-position: 0 0, 0 6px, 6px -6px, -6px 0px;
 background-repeat: repeat;
 content: "";
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),y("color-picker-slider",`
 margin-bottom: 8px;
 position: relative;
 box-sizing: border-box;
 `,[T("image",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `),H("&::after",`
 content: "";
 position: absolute;
 border-radius: inherit;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 box-shadow: inset 0 0 2px 0 rgba(0, 0, 0, .24);
 pointer-events: none;
 `)]),y("color-picker-handle",`
 z-index: 1;
 box-shadow: 0 0 2px 0 rgba(0, 0, 0, .45);
 position: absolute;
 background-color: white;
 overflow: hidden;
 `,[T("fill",`
 box-sizing: border-box;
 border: 2px solid white;
 `)]),y("color-picker-pallete",`
 height: 180px;
 position: relative;
 margin-bottom: 8px;
 cursor: crosshair;
 `,[T("layer",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `,[nt("shadowed",`
 box-shadow: inset 0 0 2px 0 rgba(0, 0, 0, .24);
 `)])]),y("color-picker-preview",`
 display: flex;
 `,[T("sliders",`
 flex: 1 0 auto;
 `),T("preview",`
 position: relative;
 height: 30px;
 width: 30px;
 margin: 0 0 8px 6px;
 border-radius: 50%;
 box-shadow: rgba(0, 0, 0, .15) 0px 0px 0px 1px inset;
 overflow: hidden;
 `),T("fill",`
 display: block;
 width: 30px;
 height: 30px;
 `),T("input",`
 position: absolute;
 top: 0;
 left: 0;
 width: 30px;
 height: 30px;
 opacity: 0;
 z-index: 1;
 `)]),y("color-picker-input",`
 display: flex;
 align-items: center;
 `,[y("input",`
 flex-grow: 1;
 flex-basis: 0;
 `),T("mode",`
 width: 72px;
 text-align: center;
 `)]),y("color-picker-control",`
 padding: 12px;
 `),y("color-picker-action",`
 display: flex;
 margin-top: -4px;
 border-top: 1px solid var(--n-divider-color);
 padding: 8px 12px;
 justify-content: flex-end;
 `,[y("button","margin-left: 8px;")]),y("color-picker-trigger",`
 border: var(--n-border);
 height: 100%;
 box-sizing: border-box;
 border-radius: var(--n-border-radius);
 transition: border-color .3s var(--n-bezier);
 cursor: pointer;
 `,[T("value",`
 white-space: nowrap;
 position: relative;
 `),T("fill",`
 border-radius: var(--n-border-radius);
 position: absolute;
 display: flex;
 align-items: center;
 justify-content: center;
 left: 4px;
 right: 4px;
 top: 4px;
 bottom: 4px;
 `),nt("disabled","cursor: not-allowed"),y("color-picker-checkboard",`
 border-radius: var(--n-border-radius);
 `,[H("&::after",`
 --n-block-size: calc((var(--n-height) - 8px) / 3);
 background-size: calc(var(--n-block-size) * 2) calc(var(--n-block-size) * 2);
 background-position: 0 0, 0 var(--n-block-size), var(--n-block-size) calc(-1 * var(--n-block-size)), calc(-1 * var(--n-block-size)) 0px; 
 `)])]),y("color-picker-swatches",`
 display: grid;
 grid-gap: 8px;
 flex-wrap: wrap;
 position: relative;
 grid-template-columns: repeat(auto-fill, 18px);
 margin-top: 10px;
 `,[y("color-picker-swatch",`
 width: 18px;
 height: 18px;
 background-image: linear-gradient(45deg, #DDD 25%, #0000 25%), linear-gradient(-45deg, #DDD 25%, #0000 25%), linear-gradient(45deg, #0000 75%, #DDD 75%), linear-gradient(-45deg, #0000 75%, #DDD 75%);
 background-size: 8px 8px;
 background-position: 0px 0, 0px 4px, 4px -4px, -4px 0px;
 background-repeat: repeat;
 `,[T("fill",`
 position: relative;
 width: 100%;
 height: 100%;
 border-radius: 3px;
 box-shadow: rgba(0, 0, 0, .15) 0px 0px 0px 1px inset;
 cursor: pointer;
 `),H("&:focus",`
 outline: none;
 `,[T("fill",[H("&::after",`
 position: absolute;
 top: 0;
 right: 0;
 bottom: 0;
 left: 0;
 background: inherit;
 filter: blur(2px);
 content: "";
 `)])])])])]),Fr=Object.assign(Object.assign({},kt.props),{value:String,show:{type:Boolean,default:void 0},defaultShow:Boolean,defaultValue:String,modes:{type:Array,default:()=>["rgb","hex","hsl"]},placement:{type:String,default:"bottom-start"},to:Ze.propTo,showAlpha:{type:Boolean,default:!0},showPreview:Boolean,swatches:Array,disabled:{type:Boolean,default:void 0},actions:{type:Array,default:null},internalActions:Array,size:String,renderLabel:Function,onComplete:Function,onConfirm:Function,"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array]}),Rr=Q({name:"ColorPicker",props:Fr,setup(e,{slots:t}){const r=L(null);let n=null;const s=Bt(e),{mergedSizeRef:o,mergedDisabledRef:a}=s,{localeRef:i}=tr("global"),{mergedClsPrefixRef:d,namespaceRef:v,inlineThemeDisabled:A}=yt(e),x=kt("ColorPicker","-color-picker",Ur,qt,e,d);Ot(rt,{themeRef:x,renderLabelRef:je(e,"renderLabel"),colorPickerSlots:t});const B=L(e.defaultShow),w=at(je(e,"show"),B);function f(l){const{onUpdateShow:g,"onUpdate:show":C}=e;g&&ze(g,l),C&&ze(C,l),B.value=l}const{defaultValue:U}=e,k=L(U===void 0?ur(e.modes,e.showAlpha):U),u=at(je(e,"value"),k),h=L([u.value]),$=L(0),se=Y(()=>Ue(u.value)),{modes:m}=e,j=L(Ue(u.value)||m[0]||"rgb");function Fe(){const{modes:l}=e,{value:g}=j,C=l.findIndex(P=>P===g);~C?j.value=l[(C+1)%l.length]:j.value="rgb"}let F,R,K,G,V,z,Z,I;const p=Y(()=>{const{value:l}=u;if(!l)return null;switch(se.value){case"hsv":return be(l);case"hsl":return[F,R,K,I]=ke(l),[...Mt(F,R,K),I];case"rgb":case"hex":return[V,z,Z,I]=ae(l),[...Ye(V,z,Z),I]}}),_=Y(()=>{const{value:l}=u;if(!l)return null;switch(se.value){case"rgb":case"hex":return ae(l);case"hsv":return[F,R,G,I]=be(l),[...ce(F,R,G),I];case"hsl":return[F,R,K,I]=ke(l),[...Qe(F,R,K),I]}}),b=Y(()=>{const{value:l}=u;if(!l)return null;switch(se.value){case"hsl":return ke(l);case"hsv":return[F,R,G,I]=be(l),[...Te(F,R,G),I];case"rgb":case"hex":return[V,z,Z,I]=ae(l),[...Je(V,z,Z),I]}}),S=Y(()=>{switch(j.value){case"rgb":case"hex":return _.value;case"hsv":return p.value;case"hsl":return b.value}}),de=L(0),oe=L(1),Me=L([0,0]);function qe(l,g){const{value:C}=p,P=de.value,D=C?C[3]:1;Me.value=[l,g];const{showAlpha:M}=e;switch(j.value){case"hsv":E((M?ve:Xe)([P,l,g,D]),"cursor");break;case"hsl":E((M?pe:Ke)([...Te(P,l,g),D]),"cursor");break;case"rgb":E((M?ue:Ge)([...ce(P,l,g),D]),"cursor");break;case"hex":E((M?he:De)([...ce(P,l,g),D]),"cursor");break}}function Re(l){de.value=l;const{value:g}=p;if(!g)return;const[,C,P,D]=g,{showAlpha:M}=e;switch(j.value){case"hsv":E((M?ve:Xe)([l,C,P,D]),"cursor");break;case"rgb":E((M?ue:Ge)([...ce(l,C,P),D]),"cursor");break;case"hex":E((M?he:De)([...ce(l,C,P),D]),"cursor");break;case"hsl":E((M?pe:Ke)([...Te(l,C,P),D]),"cursor");break}}function Ve(l){switch(j.value){case"hsv":[F,R,G]=p.value,E(ve([F,R,G,l]),"cursor");break;case"rgb":[V,z,Z]=_.value,E(ue([V,z,Z,l]),"cursor");break;case"hex":[V,z,Z]=_.value,E(he([V,z,Z,l]),"cursor");break;case"hsl":[F,R,K]=b.value,E(pe([F,R,K,l]),"cursor");break}oe.value=l}function E(l,g){g==="cursor"?n=l:n=null;const{nTriggerFormChange:C,nTriggerFormInput:P}=s,{onUpdateValue:D,"onUpdate:value":M}=e;D&&ze(D,l),M&&ze(M,l),C(),P(),k.value=l}function re(l){E(l,"input"),Ct(ne)}function ne(l=!0){const{value:g}=u;if(g){const{nTriggerFormChange:C,nTriggerFormInput:P}=s,{onComplete:D}=e;D&&D(g);const{value:M}=h,{value:W}=$;l&&(M.splice(W+1,M.length,g),$.value=W+1),C(),P()}}function ye(){const{value:l}=$;l-1<0||(E(h.value[l-1],"input"),ne(!1),$.value=l-1)}function Dt(){const{value:l}=$;l<0||l+1>=h.value.length||(E(h.value[l+1],"input"),ne(!1),$.value=l+1)}function Ut(){const{value:l}=u,{onConfirm:g}=e;g&&g(l),f(!1)}const Ft=Y(()=>$.value>=1),Rt=Y(()=>{const{value:l}=h;return l.length>1&&$.value<l.length-1});_t(w,l=>{l||(h.value=[u.value],$.value=0)}),wt(()=>{if(!(n&&n===u.value)){const{value:l}=p;l&&(de.value=l[0],oe.value=l[3],Me.value=[l[1],l[2]])}n=null});const Oe=Y(()=>{const{value:l}=o,{common:{cubicBezierEaseInOut:g},self:{textColor:C,color:P,panelFontSize:D,boxShadow:M,border:W,borderRadius:q,dividerColor:fe,[st("height",l)]:zt,[st("fontSize",l)]:It}}=x.value;return{"--n-bezier":g,"--n-text-color":C,"--n-color":P,"--n-panel-font-size":D,"--n-font-size":It,"--n-box-shadow":M,"--n-border":W,"--n-border-radius":q,"--n-height":zt,"--n-divider-color":fe}}),ie=A?jt("color-picker",Y(()=>o.value[0]),Oe,e):void 0;function Vt(){var l;const{value:g}=_,{value:C}=de,{internalActions:P,modes:D,actions:M}=e,{value:W}=x,{value:q}=d;return c("div",{class:[`${q}-color-picker-panel`,ie==null?void 0:ie.themeClass.value],onDragstart:fe=>{fe.preventDefault()},style:A?void 0:Oe.value},c("div",{class:`${q}-color-picker-control`},c(yr,{clsPrefix:q,rgba:g,displayedHue:C,displayedSv:Me.value,onUpdateSV:qe,onComplete:ne}),c("div",{class:`${q}-color-picker-preview`},c("div",{class:`${q}-color-picker-preview__sliders`},c(gr,{clsPrefix:q,hue:C,onUpdateHue:Re,onComplete:ne}),e.showAlpha?c(br,{clsPrefix:q,rgba:g,alpha:oe.value,onUpdateAlpha:Ve,onComplete:ne}):null),e.showPreview?c(Dr,{clsPrefix:q,mode:j.value,color:_.value&&De(_.value),onUpdateColor:fe=>E(fe,"input")}):null),c(Mr,{clsPrefix:q,showAlpha:e.showAlpha,mode:j.value,modes:D,onUpdateMode:Fe,value:u.value,valueArr:S.value,onUpdateValue:re}),((l=e.swatches)===null||l===void 0?void 0:l.length)&&c(Ar,{clsPrefix:q,mode:j.value,swatches:e.swatches,onUpdateColor:fe=>E(fe,"input")})),M!=null&&M.length?c("div",{class:`${q}-color-picker-action`},M.includes("confirm")&&c(Ne,{size:"small",onClick:Ut,theme:W.peers.Button,themeOverrides:W.peerOverrides.Button},{default:()=>i.value.confirm})):null,t.action?c("div",{class:`${q}-color-picker-action`},{default:t.action}):P?c("div",{class:`${q}-color-picker-action`},P.includes("undo")&&c(Ne,{size:"small",onClick:ye,disabled:!Ft.value,theme:W.peers.Button,themeOverrides:W.peerOverrides.Button},{default:()=>i.value.undo}),P.includes("redo")&&c(Ne,{size:"small",onClick:Dt,disabled:!Rt.value,theme:W.peers.Button,themeOverrides:W.peerOverrides.Button},{default:()=>i.value.redo})):null)}return{mergedClsPrefix:d,namespace:v,selfRef:r,hsla:b,rgba:_,mergedShow:w,mergedDisabled:a,isMounted:Kt(),adjustedTo:Ze(e),mergedValue:u,handleTriggerClick(){f(!0)},handleClickOutside(l){var g;!((g=r.value)===null||g===void 0)&&g.contains(l.target)||f(!1)},renderPanel:Vt,cssVars:A?void 0:Oe,themeClass:ie==null?void 0:ie.themeClass,onRender:ie==null?void 0:ie.onRender}},render(){const{$slots:e,mergedClsPrefix:t,onRender:r}=this;return r==null||r(),c("div",{class:[this.themeClass,`${t}-color-picker`],ref:"selfRef",style:this.cssVars},c(rr,null,{default:()=>[c(nr,null,{default:()=>c(Pr,{clsPrefix:t,value:this.mergedValue,hsla:this.hsla,disabled:this.mergedDisabled,onClick:this.handleTriggerClick},{label:e.label})}),c(sr,{placement:this.placement,show:this.mergedShow,containerClass:this.namespace,teleportDisabled:this.adjustedTo===Ze.tdkey,to:this.adjustedTo},{default:()=>c(Gt,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>this.mergedShow?St(this.renderPanel(),[[Xt,this.handleClickOutside,void 0,{capture:!0}]]):null})})]}))}});function dt(e,t,r,n=s=>s){return e*n(.5-t*(.5-r))}function Vr(e){return[-e[0],-e[1]]}function te(e,t){return[e[0]+t[0],e[1]+t[1]]}function J(e,t){return[e[0]-t[0],e[1]-t[1]]}function ee(e,t){return[e[0]*t,e[1]*t]}function zr(e,t){return[e[0]/t,e[1]/t]}function $e(e){return[e[1],-e[0]]}function Ir(e,t){return e[0]*t[0]+e[1]*t[1]}function Lr(e,t){return e[0]===t[0]&&e[1]===t[1]}function Nr(e){return Math.hypot(e[0],e[1])}function Tr(e){return e[0]*e[0]+e[1]*e[1]}function ct(e,t){return Tr(J(e,t))}function $t(e){return zr(e,Nr(e))}function Hr(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function Ee(e,t,r){let n=Math.sin(r),s=Math.cos(r),o=e[0]-t[0],a=e[1]-t[1],i=o*s-a*n,d=o*n+a*s;return[i+t[0],d+t[1]]}function We(e,t,r){return te(e,ee(J(t,e),r))}function ht(e,t,r){return te(e,ee(t,r))}var{min:we,PI:Br}=Math,pt=.275,Ae=Br+1e-4;function qr(e,t={}){let{size:r=16,smoothing:n=.5,thinning:s=.5,simulatePressure:o=!0,easing:a=p=>p,start:i={},end:d={},last:v=!1}=t,{cap:A=!0,easing:x=p=>p*(2-p)}=i,{cap:B=!0,easing:w=p=>--p*p*p+1}=d;if(e.length===0||r<=0)return[];let f=e[e.length-1].runningLength,U=i.taper===!1?0:i.taper===!0?Math.max(r,f):i.taper,k=d.taper===!1?0:d.taper===!0?Math.max(r,f):d.taper,u=Math.pow(r*n,2),h=[],$=[],se=e.slice(0,10).reduce((p,_)=>{let b=_.pressure;if(o){let S=we(1,_.distance/r),de=we(1,1-S);b=we(1,p+(de-p)*(S*pt))}return(p+b)/2},e[0].pressure),m=dt(r,s,e[e.length-1].pressure,a),j,Fe=e[0].vector,F=e[0].point,R=F,K=F,G=R;for(let p=0;p<e.length;p++){let{pressure:_}=e[p],{point:b,vector:S,distance:de,runningLength:oe}=e[p];if(p<e.length-1&&f-oe<3)continue;if(s){if(o){let re=we(1,de/r),ne=we(1,1-re);_=we(1,se+(ne-se)*(re*pt))}m=dt(r,s,_,a)}else m=r/2;j===void 0&&(j=m);let Me=oe<U?x(oe/U):1,qe=f-oe<k?w((f-oe)/k):1;if(m=Math.max(.01,m*Math.min(Me,qe)),p===e.length-1){let re=ee($e(S),m);h.push(J(b,re)),$.push(te(b,re));continue}let Re=e[p+1].vector,Ve=Ir(S,Re);if(Ve<0){let re=ee($e(Fe),m);for(let ne=1/13,ye=0;ye<=1;ye+=ne)K=Ee(J(b,re),b,Ae*ye),h.push(K),G=Ee(te(b,re),b,Ae*-ye),$.push(G);F=K,R=G;continue}let E=ee($e(We(Re,S,Ve)),m);K=J(b,E),(p<=1||ct(F,K)>u)&&(h.push(K),F=K),G=te(b,E),(p<=1||ct(R,G)>u)&&($.push(G),R=G),se=_,Fe=S}let V=e[0].point.slice(0,2),z=e.length>1?e[e.length-1].point.slice(0,2):te(e[0].point,[1,1]),Z=[],I=[];if(e.length===1){if(!(U||k)||v){let p=ht(V,$t($e(J(V,z))),-(j||m)),_=[];for(let b=1/13,S=b;S<=1;S+=b)_.push(Ee(p,V,Ae*2*S));return _}}else{if(!(U||k&&e.length===1))if(A)for(let _=1/13,b=_;b<=1;b+=_){let S=Ee($[0],V,Ae*b);Z.push(S)}else{let _=J(h[0],$[0]),b=ee(_,.5),S=ee(_,.51);Z.push(J(V,b),J(V,S),te(V,S),te(V,b))}let p=$e(Vr(e[e.length-1].vector));if(k||U&&e.length===1)I.push(z);else if(B){let _=ht(z,p,m);for(let b=1/29,S=b;S<1;S+=b)I.push(Ee(_,z,Ae*3*S))}else I.push(te(z,ee(p,m)),te(z,ee(p,m*.99)),J(z,ee(p,m*.99)),J(z,ee(p,m)))}return h.concat(I,$.reverse(),Z)}function Or(e,t={}){var r;let{streamline:n=.5,size:s=16,last:o=!1}=t;if(e.length===0)return[];let a=.15+(1-n)*.85,i=Array.isArray(e[0])?e:e.map(({x:w,y:f,pressure:U=.5})=>[w,f,U]);if(i.length===2){let w=i[1];i=i.slice(0,-1);for(let f=1;f<5;f++)i.push(We(i[0],w,f/4))}i.length===1&&(i=[...i,[...te(i[0],[1,1]),...i[0].slice(2)]]);let d=[{point:[i[0][0],i[0][1]],pressure:i[0][2]>=0?i[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],v=!1,A=0,x=d[0],B=i.length-1;for(let w=1;w<i.length;w++){let f=o&&w===B?i[w].slice(0,2):We(x.point,i[w],a);if(Lr(x.point,f))continue;let U=Hr(f,x.point);if(A+=U,w<B&&!v){if(A<s)continue;v=!0}x={point:f,pressure:i[w][2]>=0?i[w][2]:.5,vector:$t(J(x.point,f)),distance:U,runningLength:A},d.push(x)}return d[0].vector=((r=d[1])==null?void 0:r.vector)||[0,0],d}function jr(e,t={}){return qr(Or(e,t),t)}var Kr=jr,Gr=Object.defineProperty,ft=Object.getOwnPropertySymbols,Xr=Object.prototype.hasOwnProperty,Zr=Object.prototype.propertyIsEnumerable,mt=(e,t,r)=>t in e?Gr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,et=(e,t)=>{for(var r in t||(t={}))Xr.call(t,r)&&mt(e,r,t[r]);if(ft)for(var r of ft(t))Zr.call(t,r)&&mt(e,r,t[r]);return e},Yr=()=>({events:{},emit(e,...t){(this.events[e]||[]).forEach(r=>r(...t))},on(e,t){return(this.events[e]=this.events[e]||[]).push(t),()=>this.events[e]=(this.events[e]||[]).filter(r=>r!==t)}});function He(e,t){return e-t}function Jr(e){return e<0?-1:1}function Be(e){return[Math.abs(e),Jr(e)]}function Et(){const e=()=>((1+Math.random())*65536|0).toString(16).substring(1);return`${e()+e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}var Qr=2,le=Qr,Ce=class{constructor(e){this.drauu=e,this.event=void 0,this.point=void 0,this.start=void 0,this.el=null}onSelected(e){}onUnselected(){}onStart(e){}onMove(e){return!1}onEnd(e){}get brush(){return this.drauu.brush}get shiftPressed(){return this.drauu.shiftPressed}get altPressed(){return this.drauu.altPressed}get svgElement(){return this.drauu.el}getMousePosition(e){var t,r;const n=this.drauu.el,s=(t=this.drauu.options.coordinateScale)!=null?t:1;if(this.drauu.options.coordinateTransform===!1){const o=this.drauu.el.getBoundingClientRect();return{x:(e.pageX-o.left)*s,y:(e.pageY-o.top)*s,pressure:e.pressure}}else{const o=this.drauu.svgPoint;o.x=e.clientX,o.y=e.clientY;const a=o.matrixTransform((r=n.getScreenCTM())==null?void 0:r.inverse());return{x:a.x*s,y:a.y*s,pressure:e.pressure}}}createElement(e,t){var r;const n=document.createElementNS("http://www.w3.org/2000/svg",e),s=t?et(et({},this.brush),t):this.brush;return n.setAttribute("fill",(r=s.fill)!=null?r:"transparent"),n.setAttribute("stroke",s.color),n.setAttribute("stroke-width",s.size.toString()),n.setAttribute("stroke-linecap","round"),s.dasharray&&n.setAttribute("stroke-dasharray",s.dasharray),n}attr(e,t){this.el.setAttribute(e,typeof t=="string"?t:t.toFixed(le))}_setEvent(e){this.event=e,this.point=this.getMousePosition(e)}_eventDown(e){return this._setEvent(e),this.start=this.point,this.onStart(this.point)}_eventMove(e){return this._setEvent(e),this.onMove(this.point)}_eventUp(e){return this._setEvent(e),this.onEnd(this.point)}},Wr=class extends Ce{constructor(){super(...arguments),this.points=[]}onStart(e){return this.el=document.createElementNS("http://www.w3.org/2000/svg","path"),this.points=[e],this.attr("fill",this.brush.color),this.attr("d",this.getSvgData(this.points)),this.el}onMove(e){return this.el||this.onStart(e),this.points[this.points.length-1]!==e&&this.points.push(e),this.attr("d",this.getSvgData(this.points)),!0}onEnd(){const e=this.el;return this.el=null,!!e}getSvgData(e){const t=Kr(e,et({size:this.brush.size*2,thinning:.9,simulatePressure:!1,start:{taper:5},end:{taper:5}},this.brush.stylusOptions));if(!t.length)return"";const r=t.reduce((n,[s,o],a,i)=>{const[d,v]=i[(a+1)%i.length];return n.push(s,o,(s+d)/2,(o+v)/2),n},["M",...t[0],"Q"]);return r.push("Z"),r.map(n=>typeof n=="number"?n.toFixed(2):n).join(" ")}},en=class extends Ce{onStart(e){return this.el=this.createElement("ellipse"),this.attr("cx",e.x),this.attr("cy",e.y),this.el}onMove(e){if(!this.el||!this.start)return!1;let[t,r]=Be(e.x-this.start.x),[n,s]=Be(e.y-this.start.y);if(this.shiftPressed){const o=Math.min(t,n);t=o,n=o}if(this.altPressed)this.attr("cx",this.start.x),this.attr("cy",this.start.y),this.attr("rx",t),this.attr("ry",n);else{const[o,a]=[this.start.x,this.start.x+t*r].sort(He),[i,d]=[this.start.y,this.start.y+n*s].sort(He);this.attr("cx",(o+a)/2),this.attr("cy",(i+d)/2),this.attr("rx",(a-o)/2),this.attr("ry",(d-i)/2)}return!0}onEnd(){const e=this.el;return this.el=null,!(!e||!e.getTotalLength())}};function At(e,t){const r=document.createElementNS("http://www.w3.org/2000/svg","defs"),n=document.createElementNS("http://www.w3.org/2000/svg","marker"),s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("fill",t),n.setAttribute("id",e),n.setAttribute("viewBox","0 -5 10 10"),n.setAttribute("refX","5"),n.setAttribute("refY","0"),n.setAttribute("markerWidth","4"),n.setAttribute("markerHeight","4"),n.setAttribute("orient","auto"),s.setAttribute("d","M0,-5L10,0L0,5"),n.appendChild(s),r.appendChild(n),r}var tn=class extends Ce{onStart(e){if(this.el=this.createElement("line",{fill:"transparent"}),this.attr("x1",e.x),this.attr("y1",e.y),this.attr("x2",e.x),this.attr("y2",e.y),this.brush.arrowEnd){const t=Et(),r=document.createElementNS("http://www.w3.org/2000/svg","g");return r.append(At(t,this.brush.color)),r.append(this.el),this.attr("marker-end",`url(#${t})`),r}return this.el}onMove(e){if(!this.el)return!1;let{x:t,y:r}=e;if(this.shiftPressed){const n=e.x-this.start.x,s=e.y-this.start.y;if(s!==0){let o=n/s;o=Math.round(o),Math.abs(o)<=1?(t=this.start.x+s*o,r=this.start.y+s):(t=this.start.x+n,r=this.start.y)}}return this.altPressed?(this.attr("x1",this.start.x*2-t),this.attr("y1",this.start.y*2-r),this.attr("x2",t),this.attr("y2",r)):(this.attr("x1",this.start.x),this.attr("y1",this.start.y),this.attr("x2",t),this.attr("y2",r)),!0}onEnd(){const e=this.el;return this.el=null,!(!e||e.getTotalLength()<5)}},rn=class extends Ce{onStart(e){return this.el=this.createElement("rect"),this.brush.cornerRadius&&(this.attr("rx",this.brush.cornerRadius),this.attr("ry",this.brush.cornerRadius)),this.attr("x",e.x),this.attr("y",e.y),this.el}onMove(e){if(!this.el||!this.start)return!1;let[t,r]=Be(e.x-this.start.x),[n,s]=Be(e.y-this.start.y);if(this.shiftPressed){const o=Math.min(t,n);t=o,n=o}if(this.altPressed)this.attr("x",this.start.x-t),this.attr("y",this.start.y-n),this.attr("width",t*2),this.attr("height",n*2);else{const[o,a]=[this.start.x,this.start.x+t*r].sort(He),[i,d]=[this.start.y,this.start.y+n*s].sort(He);this.attr("x",o),this.attr("y",i),this.attr("width",a-o),this.attr("height",d-i)}return!0}onEnd(){const e=this.el;return this.el=null,!(!e||!e.getTotalLength())}};function nn(e,t){const r=e.x-t.x,n=e.y-t.y;return r*r+n*n}function sn(e,t,r){let n=t.x,s=t.y,o=r.x-n,a=r.y-s;if(o!==0||a!==0){const i=((e.x-n)*o+(e.y-s)*a)/(o*o+a*a);i>1?(n=r.x,s=r.y):i>0&&(n+=o*i,s+=a*i)}return o=e.x-n,a=e.y-s,o*o+a*a}function on(e,t){let r=e[0];const n=[r];let s;for(let o=1,a=e.length;o<a;o++)s=e[o],nn(s,r)>t&&(n.push(s),r=s);return r!==s&&s&&n.push(s),n}function tt(e,t,r,n,s){let o=n,a=0;for(let i=t+1;i<r;i++){const d=sn(e[i],e[t],e[r]);d>o&&(a=i,o=d)}o>n&&(a-t>1&&tt(e,t,a,n,s),s.push(e[a]),r-a>1&&tt(e,a,r,n,s))}function an(e,t){const r=e.length-1,n=[e[0]];return tt(e,0,r,t,n),n.push(e[r]),n}function gt(e,t,r=!1){if(e.length<=2)return e;const n=t!==void 0?t*t:1;return e=r?e:on(e,n),e=an(e,n),e}var ln=class extends Ce{constructor(){super(...arguments),this.points=[],this.count=0}onStart(e){if(this.el=this.createElement("path",{fill:"transparent"}),this.points=[e],this.brush.arrowEnd){this.arrowId=Et();const t=At(this.arrowId,this.brush.color);this.el.appendChild(t)}return this.el}onMove(e){return this.el||this.onStart(e),this.points[this.points.length-1]!==e&&(this.points.push(e),this.count+=1),this.count>5&&(this.points=gt(this.points,1,!0),this.count=0),this.attr("d",bt(this.points)),!0}onEnd(){const e=this.el;return this.el=null,!(!e||(e.setAttribute("d",bt(gt(this.points,1,!0))),!e.getTotalLength()))}};function un(e,t){const r=t.x-e.x,n=t.y-e.y;return{length:Math.sqrt(Math.pow(r,2)+Math.pow(n,2)),angle:Math.atan2(n,r)}}function vt(e,t,r,n){const s=t||e,o=r||e,a=.2,i=un(s,o),d=i.angle+(n?Math.PI:0),v=i.length*a,A=e.x+Math.cos(d)*v,x=e.y+Math.sin(d)*v;return{x:A,y:x}}function dn(e,t,r){const n=vt(r[t-1],r[t-2],e),s=vt(e,r[t-1],r[t+1],!0);return`C ${n.x.toFixed(le)},${n.y.toFixed(le)} ${s.x.toFixed(le)},${s.y.toFixed(le)} ${e.x.toFixed(le)},${e.y.toFixed(le)}`}function bt(e){return e.reduce((t,r,n,s)=>n===0?`M ${r.x.toFixed(le)},${r.y.toFixed(le)}`:`${t} ${dn(r,n,s)}`,"")}var cn=class extends Ce{constructor(){super(...arguments),this.pathSubFactor=20,this.pathFragments=[]}onSelected(e){const t=(r,n)=>{if(r&&r.length)for(let s=0;s<r.length;s++){const o=r[s];if(o.getTotalLength){const a=o.getTotalLength();for(let i=0;i<this.pathSubFactor;i++){const d=o.getPointAtLength(a*i/this.pathSubFactor),v=o.getPointAtLength(a*(i+1)/this.pathSubFactor);this.pathFragments.push({x1:d.x,x2:v.x,y1:d.y,y2:v.y,segment:i,element:n||o})}}else o.children&&t(o.children,o)}};e&&t(e.children)}onUnselected(){this.pathFragments=[]}onStart(e){this.svgPointPrevious=this.svgElement.createSVGPoint(),this.svgPointPrevious.x=e.x,this.svgPointPrevious.y=e.y}onMove(e){this.svgPointCurrent=this.svgElement.createSVGPoint(),this.svgPointCurrent.x=e.x,this.svgPointCurrent.y=e.y;const t=this.checkAndEraseElement();return this.svgPointPrevious=this.svgPointCurrent,t}onEnd(){return this.svgPointPrevious=void 0,this.svgPointCurrent=void 0,!0}checkAndEraseElement(){const e=[];if(this.pathFragments.length)for(let t=0;t<this.pathFragments.length;t++){const r=this.pathFragments[t],n={x1:this.svgPointPrevious.x,x2:this.svgPointCurrent.x,y1:this.svgPointPrevious.y,y2:this.svgPointCurrent.y};this.lineLineIntersect(r,n)&&(r.element.remove(),e.push(t))}return e.length&&(this.pathFragments=this.pathFragments.filter((t,r)=>!e.includes(r))),e.length>0}lineLineIntersect(e,t){const r=e.x1,n=e.x2,s=t.x1,o=t.x2,a=e.y1,i=e.y2,d=t.y1,v=t.y2,A=(r-n)*(d-v)-(a-i)*(s-o),x=(r*i-a*n)*(s-o)-(r-n)*(s*v-d*o),B=(r*i-a*n)*(d-v)-(a-i)*(s*v-d*o),w=(f,U,k)=>f>=U&&f<=k?!0:f>=k&&f<=U;if(A===0)return!1;{const f={x:x/A,y:B/A};return w(f.x,r,n)&&w(f.y,a,i)&&w(f.x,s,o)&&w(f.y,d,v)}}};function hn(e){return{draw:new ln(e),stylus:new Wr(e),line:new tn(e),rectangle:new rn(e),ellipse:new en(e),eraseLine:new cn(e)}}var pn=class{constructor(e={}){this.options=e,this.el=null,this.svgPoint=null,this.eventEl=null,this.shiftPressed=!1,this.altPressed=!1,this.drawing=!1,this._emitter=Yr(),this._models=hn(this),this._undoStack=[],this._disposables=[],this.options.brush||(this.options.brush={color:"black",size:3,mode:"stylus"}),e.el&&this.mount(e.el,e.eventTarget)}get model(){return this._models[this.mode]}get mounted(){return!!this.el}get mode(){return this.options.brush.mode||"stylus"}set mode(e){this._models[this.mode].onUnselected(),this.options.brush.mode=e,this.model.onSelected(this.el)}get brush(){return this.options.brush}set brush(e){this.options.brush=e}resolveSelector(e){return typeof e=="string"?document.querySelector(e):e||null}mount(e,t){if(this.el)throw new Error("[drauu] already mounted, unmount previous target first");if(this.el=this.resolveSelector(e),!this.el)throw new Error("[drauu] target element not found");if(this.el.tagName.toLocaleLowerCase()!=="svg")throw new Error("[drauu] can only mount to a SVG element");if(!this.el.createSVGPoint)throw new Error("[drauu] SVG element must be create by document.createElementNS('http://www.w3.org/2000/svg', 'svg')");this.svgPoint=this.el.createSVGPoint();const r=this.resolveSelector(t)||this.el,n=this.eventStart.bind(this),s=this.eventMove.bind(this),o=this.eventEnd.bind(this),a=this.eventKeyboard.bind(this);r.addEventListener("pointerdown",n,{passive:!1}),window.addEventListener("pointermove",s,{passive:!1}),window.addEventListener("pointerup",o,{passive:!1}),window.addEventListener("pointercancel",o,{passive:!1}),window.addEventListener("keydown",a,!1),window.addEventListener("keyup",a,!1),this._disposables.push(()=>{r.removeEventListener("pointerdown",n),window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",o),window.removeEventListener("keydown",a,!1),window.removeEventListener("keyup",a,!1)}),this._emitter.emit("mounted")}unmount(){this._disposables.forEach(e=>e()),this._disposables.length=0,this.el=null,this._emitter.emit("unmounted")}on(e,t){return this._emitter.on(e,t)}undo(){const e=this.el;return e.lastElementChild?(this._undoStack.push(e.lastElementChild.cloneNode(!0)),e.lastElementChild.remove(),this._emitter.emit("changed"),!0):!1}redo(){return this._undoStack.length?(this.el.appendChild(this._undoStack.pop()),this._emitter.emit("changed"),!0):!1}canRedo(){return!!this._undoStack.length}canUndo(){var e;return!!((e=this.el)!=null&&e.lastElementChild)}eventMove(e){!this.acceptsInput(e)||!this.drawing||this.model._eventMove(e)&&(e.stopPropagation(),e.preventDefault(),this._emitter.emit("changed"))}eventStart(e){!this.acceptsInput(e)||(e.stopPropagation(),e.preventDefault(),this._currentNode&&this.cancel(),this.drawing=!0,this._emitter.emit("start"),this._currentNode=this.model._eventDown(e),this._currentNode&&this.mode!=="eraseLine"&&this.el.appendChild(this._currentNode),this._emitter.emit("changed"))}eventEnd(e){if(!this.acceptsInput(e)||!this.drawing)return;const t=this.model._eventUp(e);t?(t instanceof Element&&t!==this._currentNode&&(this._currentNode=t),this.commit()):this.cancel(),this.drawing=!1,this._emitter.emit("end"),this._emitter.emit("changed")}acceptsInput(e){return!this.options.acceptsInputTypes||this.options.acceptsInputTypes.includes(e.pointerType)}eventKeyboard(e){this.shiftPressed===e.shiftKey&&this.altPressed===e.altKey||(this.shiftPressed=e.shiftKey,this.altPressed=e.altKey,this.model.point&&this.model.onMove(this.model.point)&&this._emitter.emit("changed"))}commit(){this._undoStack.length=0;const e=this._currentNode;this._currentNode=void 0,this._emitter.emit("committed",e)}clear(){this._undoStack.length=0,this.cancel(),this.el.innerHTML="",this._emitter.emit("changed")}cancel(){this._currentNode&&(this.el.removeChild(this._currentNode),this._currentNode=void 0,this._emitter.emit("canceled"))}dump(){return this.el.innerHTML}load(e){this.clear(),this.el.innerHTML=e}};function fn(e){return new pn(e)}const mn=X("\u21A9\uFE0F"),gn=X("\u21AA\uFE0F"),vn=X("\u{1F5D1}"),bn=X("\u270D\uFE0F"),yn=X("\u26AA\uFE0F"),xn=X(" \u270F\uFE0F "),wn=X("\u2044"),kn=X("\u2197 "),_n=X("\u20DE"),Sn=X("\u20DD"),Cn=["title"],Mn=X("\u2014"),Pn=X("\u2505 "),$n=X("\u22EF"),En=X("\u{1F4E5}"),An={id:"svg","w-full":"","flex-auto":"","z-10":"",h350:"",border:"",style:{"touch-action":"none"}},Dn=Q({name:"drawing-drauu"}),Un=Q({...Dn,setup(e){let t;Zt(()=>{t=fn({el:"#svg",brush:{color:"#000",size:3,dasharray:void 0}})});const r=L("stylus");function n(k){t.mode=k;const h=t.options.brush;h.arrowEnd=!1,r.value=k}function s(){t.mode="line";const u=t.options.brush;u.arrowEnd=!0,r.value="arrow"}const o=L("dark"),a=k=>{const h=t.options.brush;h.color=k,o.value="undefined"},i=L(3);_t(i,(k,u)=>{Ct(()=>{const $=t.options.brush;$.size=k})},{immediate:!0,deep:!0});function d(){t.undo()}function v(){t.redo()}function A(){t.clear()}const x=L("solid");function B(){const u=t.options.brush;u.dasharray=void 0,x.value="solid"}function w(){const u=t.options.brush;u.dasharray="4",x.value="dasharray"}function f(){const u=t.options.brush;u.dasharray="1 7",x.value="dotted"}function U(){t.el.setAttribute("xmlns","http://www.w3.org/2000/svg");const k=t.el.outerHTML||"",u=new Blob([k],{type:"image/svg+xml"}),h=window.document.createElement("a");h.href=window.URL.createObjectURL(u),h.download="drauu.svg",document.body.appendChild(h),h.click(),document.body.removeChild(h)}return Yt(()=>{console.log("\u6FC0\u6D3B\u3010analysis\u3011===keep-alive===onActivated"+new Date)}),Jt(()=>{console.log("\u505C\u6B62\u3010analysis\u3011===keep-alive===onDeactivated"+new Date)}),(k,u)=>{const h=Ne,$=Rr,se=or;return ot(),it("div",null,[N(se,{"mb-2":""},{default:O(()=>[N(h,{id:"undo",title:"\u64A4\u9500",onClick:u[0]||(u[0]=m=>d())},{default:O(()=>[mn]),_:1}),N(h,{id:"redo",title:"\u8FD8\u539F",onClick:u[1]||(u[1]=m=>v())},{default:O(()=>[gn]),_:1}),N(h,{id:"clear",title:"\u6E05\u9664",style:{"font-size":"25px"},onClick:u[2]||(u[2]=m=>A())},{default:O(()=>[vn]),_:1}),N(h,{id:"m-stylus",title:"Stylus",type:r.value==="stylus"?"primary":void 0,dashed:"",onClick:u[3]||(u[3]=m=>n("stylus"))},{default:O(()=>[bn]),_:1},8,["type"]),N(h,{id:"m-eraser",title:"Eraser",type:r.value==="eraseLine"?"primary":void 0,dashed:"",onClick:u[4]||(u[4]=m=>n("eraseLine"))},{default:O(()=>[yn]),_:1},8,["type"]),N(h,{id:"m-draw",title:"\u7B14",type:r.value==="draw"?"primary":void 0,dashed:"",onClick:u[5]||(u[5]=m=>n("draw"))},{default:O(()=>[xn]),_:1},8,["type"]),N(h,{id:"m-line",title:"\u76F4\u7EBF",type:r.value==="line"?"primary":void 0,"pl-6":"","pr-6":"",dashed:"",onClick:u[6]||(u[6]=m=>n("line"))},{default:O(()=>[wn]),_:1},8,["type"]),N(h,{id:"m-arrow",title:"\u7BAD\u5934",type:r.value==="arrow"?"primary":void 0,dashed:"",onClick:u[7]||(u[7]=m=>s())},{default:O(()=>[kn]),_:1},8,["type"]),N(h,{id:"m-rect",title:"\u957F\u65B9\u5F62",type:r.value==="rectangle"?"primary":void 0,"pl-6":"","pr-6":"",dashed:"",onClick:u[8]||(u[8]=m=>n("rectangle"))},{default:O(()=>[_n]),_:1},8,["type"]),N(h,{id:"m-ellipse",title:"\u692D\u5706",type:r.value==="ellipse"?"primary":void 0,"pl-4":"","pr-8":"",dashed:"",onClick:u[9]||(u[9]=m=>n("ellipse"))},{default:O(()=>[Sn]),_:1},8,["type"]),N($,{"pt-4":"","pb-4":"","pl-12":"","pr-12":"",modes:["hex"],swatches:["#FFFFFF","#18A058","#2080F0","#F0A020","rgba(208, 48, 80, 1)"],actions:["confirm"],onConfirm:a},null,8,["swatches"]),St(Wt("input",{"onUpdate:modelValue":u[10]||(u[10]=m=>i.value=m),flex:"","items-center":"",h7:"",type:"range",min:"1",max:"10",step:"0.5",name:"Size",title:"\u7B14\u753B\u7C97\u7EC6 "+i.value+" "},null,8,Cn),[[Qt,i.value]]),N(h,{title:"Solid",type:x.value==="solid"&&r.value!=="stylus"&&r.value!=="eraseLine"?"primary":void 0,dashed:"",onClick:u[11]||(u[11]=m=>B())},{default:O(()=>[Mn]),_:1},8,["type"]),N(h,{title:"Dashed",type:x.value==="dashed"&&r.value!=="stylus"&&r.value!=="eraseLine"?"primary":void 0,dashed:"",onClick:u[12]||(u[12]=m=>w())},{default:O(()=>[Pn]),_:1},8,["type"]),N(h,{title:"Dotted",type:x.value==="dotted"&&r.value!=="stylus"&&r.value!=="eraseLine"?"primary":void 0,dashed:"",onClick:u[13]||(u[13]=m=>f())},{default:O(()=>[$n]),_:1},8,["type"]),N(h,{title:"Download",onClick:u[14]||(u[14]=m=>U())},{default:O(()=>[En]),_:1})]),_:1}),(ot(),it("svg",An))])}}});typeof lt=="function"&&lt(Un);export{Un as default};
